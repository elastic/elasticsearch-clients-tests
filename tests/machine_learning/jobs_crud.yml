---
"Test get all jobs and stats given no job exists":

  - do:
      ml.get_jobs:
        job_id: "_all"
  - match: { count: 0 }
  - match: { jobs: [] }

  - do:
      ml.get_job_stats:
        job_id: "_all"
  - match: { count: 0 }
  - match: { jobs: [] }
  - do:
      ml.put_job:
        job_id: job-crud-test-apis
        body:  >
          {
            "description":"Analysis of response time by airline",
            "analysis_config" : {
                "bucket_span": "1h",
                "detectors" :[{"function":"metric","field_name":"responsetime","by_field_name":"airline"}]
            },
            "data_description" : {
                "time_field":"time",
                "time_format":"yyyy-MM-dd HH:mm:ssX"
            }
          }
  - match: { job_id: "job-crud-test-apis" }
  - match: { analysis_limits.model_memory_limit: "1024mb" }
  - match: { analysis_limits.categorization_examples_limit: 4 }
  - is_true: create_time

  - do:
      ml.get_jobs:
        job_id: "job-crud-test-apis"
  - match: { count: 1 }
  - match: { jobs.0.job_id: "job-crud-test-apis" }
  - match: { jobs.0.analysis_limits.model_memory_limit: "1024mb" }

  - do:
      ml.update_job:
        job_id: "job-crud-test-apis"
        body:  >
          {
            "analysis_limits": {
              "model_memory_limit": "20mb"
            }
          }
  - match: { analysis_limits.model_memory_limit: "20mb" }

  - do:
      ml.delete_job:
        job_id: "job-crud-test-apis"
  - match: { acknowledged: true }
